# link layer
- 포워딩 담당.
- datagram을 encapsulate -> frame
- MAC 주소로 노드를 인식(하드웨어의 static한 주소)

서비스
- flow control
  - transmission레이어랑 별개. 가까이이는 노드들끼리의 flowcontrol. 주변 link들의 간섭으로 error발생가능->기다렸다보낸다던가.
- error detection
  - network에서는 빠졌지만 여긴 있음
- error correction
  - frame단위로 재전송
- half-duplex/full-duplex
  - 단방향이냐 양방향이냐





# Error detection
> EDC 뭔지 설명할 수 있어야.

EDC(Error detection and Correction bits)
데이터 D는 frame 안에서 EDC라는 bit와 함께 보내진다. (이게 mac protocol에 있는건가?)

receiver는 D'와 EDC'을 받는다.(아니 에러잡으라고 보낸 비트까지 에러나면 어쩌란겨:?)
EDC가 모든에러를 잡진 못한다.
EDC가 그자리에서 에러를 고치는가? 아니면 재전송만 유발하는가? 하지만 재전송만 유발한다면 왜 Correction이 들어있는데?


## Parity checking
single bit parity: 1차원
- d bit라면 d+1 bit가 짝수가 되도록 하는 1 bit 추가.
- 근데 에러가 짝수개 난다면 -> undetected error
- 보통 에러날 때 여러개가 같이남 -> undetected error확률 50%...

two-dimensional bit parity
- i행과 j열마다 parity값 계산 -> i+j+1개의 parity bit
- 에러한개 -> 어디서났는지 알고 correction도 가능.
  - d,c둘다가능: FEC(forward error correction). sender의 재전송 횟수를 줄여서 좋음. round-trip propagation delay줄임.

## Checksumming
byte를 16 bit int로 만들어서합침
- TCP UDP에서는 헤더,바디 다 체크섬함
- IP에서는 헤더만 함(TCP UDP에서 자기꺼다하니까)
- 오버헤드가 적음, 하지만 약함 그래서 link에서는 CRC가 더 많이 쓰임. 왜냐면 transport에서와 달리 link에서는 전용 하드웨어에서 이루어져서 더 복잡한 행동을 할수있기때문.

491p 

## CRC (Cyclic redundancy check)
> CRC는 G랑 R 개념, 계산방법, 결과 판별법 설명하면 됨.


데이터에 crc bit(R)라는걸 붙여줌. R값은 redundancy
내가 보내야 하는 데이터
G: 계산하느 generater
G로 나누고 계산을 exclusive or을 하다보면 나머지가 R임.

받는쪽에서는 G와 R을 알고있음. 반대로 나눴을때 000이면 안깨지고 아니면 깨진거임.






# Multiple Access protocol
> 중요. 3가지

수시로 변하는 환경
유선에 하나만 보내면 효율이 안좋아서 여러번 보내겠다.
한번에 여러개 보내다 보면 충돌(collision)이 생긴다.

환경의 종류
- point to point: 상대편 리시버한테 꼭 가야함. 1:1.
- broadcast: 특정 목적지가 없다. 주변에 뿌려주는것. 1:n

- 충돌 없이 하나만 보내느냐(no collision)
- 충돌 생기고 여러개 보내느냐(collision) 최대한 충돌 없게하기 -> multiple access protocol






# MAC 프로토콜
> 중요. 무슨 종류가 있는지.

왜 MAC 프로토콜이냐?

- channel partitioning: 회선교환처럼 slot따위로 나눔. 충돌 배제
- taking turns: 노드가 프레임 전달할때 순서를 정해줌. 충돌 배제
- random access: 채널 나누지 않음. 충돌 있음. 최소화.

## Channel Partitioning
> 3가지

FDMA
frequency
A channel은 A주파수를, B channel은 B 주파수를.

TDMA
time
시간 단위로 쪼갬.

CDMA
code
3G, 4G(LTE?), 5G... 우리나라에서 상용화를 최초로 함.

## Taking turns
> 어떤 방식이 있는지

순서를 정해주는 거랑 타임슬롯을 나눠주는 거랑 무슨 차이지?

- polling: 상대가 응답을 주는지 확인. master -> slave
- tocken passing: 토큰이 나한테 올 때 보냄? 토큰으로 순번을 정함.

## Random Access
충돌이생겼다는건 깨졌다는것임. 재전송을해야.
유선/무선/유무선공통

- ALOHA
- slotted ALOHA
- CSMA:유무선공통, CSMA/CD:유선, CSMA/CA:무선




### Pure(unslotted) ALOHA
단순하고 동기화가 없다.
보내고싶을때 그냥 보내게한다. -> 다 가기도전에 또보냄 -> 깨짐.(동시에 여러개가 링크에 올라가있으면 무조건 충돌이일어나나?충돌이일어남은 무조건 비트가 깨짐을 의미하나?)

### Slotted ALOHA
보내는 시점을 동기화시켜서 충돌을 줄이자.

- 장점: 하나의 노드관점에서는 충돌이 없는데 여러개의 노드가 있으면 하나의 슬롯 안에서도 충돌이 생길 수 있다: 그걸 막응려고 slotted한거아닌가?

유, 무선 모두 충돌이 생김.

### CSMA (carrier sense multiple access)
보내기 전에 listen한다.
어딘가에서 보내려는 시그널이 있으면 연기함.

CSMA collision: 전파 지연시간 때문에 체크에 안 걸릴 수 있음 -> 몰랐던 충돌이 발생 가능.

> 차이 숙지

### CSMA/CD (collision detection)
유선.
보낸 후에 충돌 발생하면 감지 -> 버림
충돌 감지하자마자 버리고 재전송(효율적)

- backoff: 기다리기.
- binary backoff: 계속충돌나면 backoff interval을 늘린다?(많이 기다리게하기) 많이 기다린다고 무조건 더 좋은 건 아니지만 확률적으로 효율적임.

### CSMA/CA (collision avoidance)
무선.
보낸 후 충돌감지를 못함 -> CD는 못함.

message 기반으로








# ARP (address resolution protocol)
ip 주소를 LAN을 위해 MAC 주소로 바꾸는 테이블
DNS랑 차이점이 뭐지? 그 테이블은 어디에 담겨있지? 서버?

자기 주변의 host가 broadcast로 알려주면 자기 주변의 MAC 주소만 가지고있다가 frame 헤더에다 넣어줌.

딱 다음 노드까지만 MAC주소를 쓰게해주면 되는거임.

MAC주소도 TTL(time to live)을 가지고 있음.
기기가 꺼질수도있으니까 변할수있으니까.

그니까 ARP가 헤더라는건데 테이블은 누가만들어줌?

한 홉은 MAC 기반으로, 멀티 홉은 ip 기반으로.